%
O112(TEST M5560)
(03-12-2024 - A)

N001G21G40G80
G140G18
G501
G170
M40
G50S1400
G50P3S3000
(WORK OFFSET WIDE STOCK ABS Z SHOULD BE MAX 1542)
G10P0Z1536. (TEST SAFE AREA)
G30U0W0
/M1
M6T025300 (12MM SLOT MILL)
M43
G28H0
G50C0
G98G17 (Z-AXIS MILL)
G97
G00X190.Y0
Z10.
M1 
G262S5600M13
G66 P5560 X190. Y0. U34. V37.5 W16. Z-6.5 D1. R10. Q4. B12. E0.5 F1260.
G00C0
H90.
G67
M2

O5560(TRAPEZOID POCKET)
(11-10-2024 - A)
(MILL A TRAPEZOID POCKET WITH LH CUTTER COMPENSATION)
(AXIS SHOULD BE G17)
(X #24, Y #25, CENTRE)
(U #21 HEIGHT)
(V #22 TOP WIDTH)
(W #23 BOTTOM WIDTH)
(Z #26 TOTAL DEPTH)
(Q #17 PECK DEPTH)
(R #18 CLEARANGE HEIGHT)
(B #2 TOOL DIAMETER)
(D #7 SURFACE)
(E #8 RADIAL ENGAGEMENT OF CUTTER, 0.2 = 20PCT)
(F #9 FEED RATE)

(PARAMS)
$TOOL = [[FIX[#4120/100]]MOD100]
$MIRZ = [#3007AND4] (0, MIRROR IN Z = 1 )

(DEFAULTS)
IF [#2EQ#0] THEN #2=[[#2300+$TOOL]*2]
#159 = [#2*#8] (STEP OVER)
IF [#8GE1.] GOTO 901
IF [#26GE#7] GOTO 902
#112 = ABS[#17] (PECK, REMOVE SIGN, WILL ALLWAYS BE NEGATIVE)
#121 = ABS[#21] (HEIGHT)
#122 = ABS[#22] (OUTER TOP SIZE)
#123 = ABS[#23] (OUTER BOTTOM SIZE)

$LGSIDE = #121
#150 = 121
IF [[#122]GT[$LGSIDE]] THEN #150 = 122
IF [[#123]GT[$LGSIDE]] THEN #150 = 123

$DCL = [#26 - #7] (RELATIVE W DEPTH CUT LEFT)
IF [ABS[$DCL]LT#112] THEN #112 = ABS[$DCL]
$ACD = #7 (ABSOLUTE CUT DEPTH IN Z)
$AS = #7 (ADJUSTED SURFACE)

G00X#24Y#25
Z#18 (CLEARANCE HEIGHT)
G140G40 (CANCEL ALL COMPS)
G01Z#7F#9 (MOVE TO SURFACE)

WHILE [[$DCL]NE0] DO1
    $DCL = [$DCL - [-#112]]
    $ACD = $ACD + [-#112]
    G65 P5590 X#24 Y#25 Z[$ACD] B#2 D[$AS] Q4. H1.4 F#9 R#18 (HELICAL PECK)
    $AS = [$ACD + [#7]]
    $PCL = [#2] (RESET POCKET CUT LEFT)
    #141 = [$PCL]
    #142 = [$PCL]
    #143 = [$PCL]
    G00 X#24Y#25 (MOVE BACK TO CENTRE)
    G01 Z[$ACD] F#9

    (CUT THE POCKET)

    WHILE [[$PCL]NE#[#150]] DO2
        $PCL = [[$PCL] + #159] (NEXT CUT)
        IF [[$PCL]GT#[#150]] THEN $PCL = #[#150]
        #141 = [#141 + #159]
        IF [#141GT#121] THEN #141 = #121 (HEIGHT X)
        #142 = [#142 + #159]
        IF [#142GT#122] THEN #142 = #122 (TOP Y)
        #143 = [#143 + #159]
        IF [#143GT#123] THEN #143 = #123 (BOTTOM Y)

        (NOW PERFORM CUT)
        IF [$MIRZ] GOTO 120
            G01 X[#24+#141] Y-[#142/2] F[#9] (TOP RH CORNER)
            G03 U0 Y[#142/2] R[[#24+#141]/2] (TOP LH CORNER)
            G01 U-[#141*2] Y[#143/2] (BOTTOM LH CORNER)
            G02 U0 Y-[#143/2] R[[#24-#141]/2] (BOTTOM RH CORNER)
            G01 U[#141*2] Y-[#142/2] (BACK TO START)
        GOTO 130
        N120
            G01 X[#24+#141] Y[#142/2] F[#9] (TOP RH CORNER)
            G02 U0 Y-[#142/2] R[[#24+#141]/2] (TOP LH CORNER)
            G01 U-[#141*2] Y-[#143/2] (BOTTOM LH CORNER)
            G03 U0 Y[#143/2] R[[#24-#141]/2] (BOTTOM RH CORNER)
            G01 U[#141*2] Y[#142/2] (BACK TO START)
        N130
    END2

    IF [ABS[$DCL]LT#112] THEN #112 = ABS[$DCL]
END1

G00 X#24Y#25 (MOVE BACK TO CENTRE)
Z#18
GOTO 9999
N901#3000=001(RADIAL STEP E SHOULD BE LESS THAN 1.0)
N902#3000=002(Z DEPTH IS GREATER THAN SURFACE D)
N902#3000=003()
N9999
M99
%
