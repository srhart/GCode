%
O5511 (MACRO)
(27-09-2024 - A)
(UPDATE TO O5510 THAT SPIRAL RAMPS DOWN)
(THERE SHOULD BE A HOLE DRILLED IN THE CENTRE, ALREADY)

(MILL CONCENTRIC HOLES NO CUTTER COMPENSATION)
(TYPE II PASSED VARABLES)
(AXIS SHOULD BE G17)
(ROTATING TOOL SHOULD BE STARTED)
(FEED RATE SHOULD BE SET)
(WILL BE CLIMB CUT)
(A,B AND C ARE THE HOLE START/END POSITION)
(EACH I,J,K ARE HOLES)
(RADIUS I, DEPTH K, RAMP DEPTH J)
N001(ERROR CHECKS)
N002IF[#1EQ#0] GOTO 901
N003IF[#3EQ#0] GOTO 903
N004IF[#2EQ#0] THEN #2=0 (DEFAULT Y TO 0)
N005IF[#5EQ#0] THEN #5=2 (DEFAULT 2MM RAMP)
N006IF[#5EQ0] GOTO 904
N010$HC = 1 (HOLE COUNT)
N015$RDPTH = [-ABS[#5]] (RAMP DEPTH)
N020$RAD = ABS[#4]/2
N030$DPTH = [-ABS[#6]]
N030$WDPTH = [$DPTH] (WORKING DEPTH)
N032$TOOL = [[FIX[#4120/100]]MOD100]
N033$MIRZ = [#3007AND4] (0, MIRROR IN Z = 1 )
N034IF [$MIRZ] THEN $G = 02 
N035ELSE $G = 03
N040G40 (REMOVE ANY CC)
N050G00X#1Y#2Z#3 (RAPID TO CENTRE)
N060WHILE [[[$DPTH]NE0] AND [[$HC]LE9]] DO1
N070    G00Y[$RAD] (MOVE OUT TO RADIUS)
N080    WHILE [[$WDPTH]NE0] DO2
N085        IF[[$WDPTH]GE[$RDPTH]] THEN $RDPTH=[$WDPTH]
N086        $WDPTH=[$WDPTH - [$RDPTH]]
N090        G[$G]J[-[$RAD]] W[$RDPTH](MAKE FULL CIRCLE WITH RAMP)
N095        END2        
N100    G[$G]J[-[$RAD]] Z[$DPTH](MAKE FULL CIRCLE AT BOTTOM) 
N110    G01X#1Y#2 (RETURN TO CENTRE)
N120    $RAD=[ABS[#[$HC*3+4]]/2]
N122    IF[#[$HC*3+5]EQ#0] THEN #[$HC*3+5]=2 (DEFAULT 2MM RAMP)
N125    $RPTH=[-ABS[#[$HC*3+5]]]
N130    $DPTH=[-ABS[#[$HC*3+6]]]
N135    $WDPTH = [$DPTH] (WORKING DEPTH)
N140    $HC=$HC+1
N200    END1
N210G00Z#3 (RAPID TO CLEARANCE HEIGHT)
N220$HC = 0
N230G143

N900GOTO 999
N901#3000 = 1(X POSITION IS NOT SPECIFIED IN A)
N903#3000 = 3(Z SURFACE IS NOT SPECIFIED IN C)
N904#3000 = 4(RAMP DEPTH IS ZERO AS SPECIFIED IN J)
N999M99
%